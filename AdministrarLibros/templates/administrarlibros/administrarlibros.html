{% extends "base/base.html" %}

{% load static %}

{% block content %}
    <link href="{% static 'Biblioteca/bootstrap.min.css' %}" rel="stylesheet"> 
    <link rel="stylesheet" href="{% static 'Biblioteca/css/StylesBase.css' %}">
    <link rel="stylesheet" href="{% static 'Biblioteca\css\StylesLibros.css' %}">
    <link rel="stylesheet" href="{% static 'Biblioteca\css\StylesTablas.css' %}">
    <script defer src="{% static 'Biblioteca\js\opciones.js' %}"></script>
    &nbsp;
    {% if user.is_authenticated %}
        {% if user.groups.all %}
            {% for group in user.groups.all %}
                {% if group.name == "WorkerTeam" %}
                    <div class="opciones">
                        <div class="box">
                            <h1>¿Que actividad desea realizar?</h1>
                        </div>
                        <div class="box2">
                            <button id="BotonVisualizar" onclick="MostrarVisualizarA()" class="ops">
                                Visualizar
                            </button>
                        </div>
                    </div>    
                    <h3 style="text-align: center">Solo tienes acceso a la visualización de los libros.</h3>
                {% endif %}
            {% endfor %}
        {% else %}
            <div class="opciones">
                <div class="box">
                    <h1>¿Que actividad desea realizar?</h1>
                </div>
                <div class="box2">
                    <button id="BotonIngresar" onclick="MostrarIngresar()" class="ops">
                        Ingresar
                    </button>
                    <button id="BotonEliminar" onclick="MostrarEliminar()" class="ops">
                        Eliminar
                    </button>
                    <button id="BotonEditar" onclick="MostrarEditar()" class="ops">
                        Editar
                    </button>
                    <button id="BotonVisualizar" onclick="MostrarVisualizar()" class="ops">
                        Visualizar
                    </button>
                </div>
            </div>
        {% endif %}
        
    {% else %}
        <div class="opciones">
            <div class="box">
                <h1>¿Que actividad desea realizar?</h1>
            </div>
            <div class="box2">
                <button id="BotonVisualizar" onclick="MostrarVisualizarA()" class="ops">
                    Visualizar
                </button>
            </div>
        </div>        
    {% endif %}
        
        {% if "isvalid" in request.GET %} <!-- si se obtiene la redirección a la nueva url -->
            <script> alert('Agregado correctamente')</script>
        {% endif %}
        {% if Msm %} <!-- si se obtiene la redirección a la nueva url -->
            <script> alert('Actualizado correctamente')</script>
        {% endif %}

        <center><div id = "Ingresar" class="ingresar" style="display: none;">
            <h2>Ingresando Nuevo Libro/Tesis</h2>
            <h3>Por favor complete los campos:</h3>
            <form method="POST">
                {% csrf_token %}
                <table>{{formL.as_table}}</table>
                <button class="ingresar-button" type="submit"><strong>Ingresar Libro</strong></button>
            </form>
        </div></center>

        <div id="Visualizar" class="visualizar" style="display: none;">
            <table>
                <thead>
                    <tr>
                        <th>Cota</th>
                        <th>Nombre</th>
                        <th>Autor</th>
                        <th>Tipo</th>
                        <th>Cantidad Interna</th>
                        <th>Cantidad Externa</th>
                        <th>Cantidad Total</th>
                        <th>Categoria/Tags</th>
                        <th>Descripcion</th>
                        <th>Fecha de Ingreso</th>
                        
                    </tr>
                </thead>
                <tbody>
                    {% for libro in libros %}
                        <tr>
                            <td>{{libro.id}}</td>
                            <td>{{libro.nombre}}</td>
                            <td>{{libro.autor}}</td>
                            <td>{{libro.tipo}}</td>
                            <td>{{libro.cantidadint}}</td>
                            <td>{{libro.cantidadext}}</td>
                            <td>{{libro.cantidadint|add:libro.cantidadext}}</td>
                            <td>{{libro.categoria}}</td>
                            <td>{{libro.descripcion}}</td>
                            <td>{{libro.fecha}}</td>
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>

        <div id="Eliminar" class="eliminar" style="display: none;">
            <table>
                <thead>
                    <tr>
                        <th>Cota</th>
                        <th>Nombre</th>
                        <th>Autor</th>
                        <th>Tipo</th>
                        <th>Cantidad Interna</th>
                        <th>Cantidad Externa</th>
                        <th>Cantidad Total</th>
                        <th>Categoria/Tags</th>
                        <th>Eliminar</th>
                        
                    </tr>
                </thead>
                <tbody>
                    {% for libro in libros %}
                        <tr>
                            <td>{{libro.id}}</td>
                            <td>{{libro.nombre}}</td>
                            <td>{{libro.autor}}</td>
                            <td>{{libro.tipo}}</td>
                            <td>{{libro.cantidadint}}</td>
                            <td>{{libro.cantidadext}}</td>
                            <td>{{libro.cantidadint|add:libro.cantidadext}}</td>
                            <td>{{libro.categoria}}</td>
                            <td><form action="{% url 'Eliminarlibro' libro.id %}" method="POST">
                                    {% csrf_token %}
                                    <button type="submit" >
                                        <img src="{% static 'Biblioteca/imgprojts/recycle-bin.png' %}" alt="Eliminar Elemento" style="height: 25px;">
                                    </button>
                                </form>
                            </td>
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>

        <div id="Editar" class="editar" style="display: none;">
            <table>
                <thead>
                    <tr>
                        <th>Cota</th>
                        <th>Nombre</th>
                        <th>Autor</th>
                        <th>Tipo</th>
                        <th>Cantidad Interna</th>
                        <th>Cantidad Externa</th>
                        <th>Cantidad Total</th>
                        <th>Categoria/Tags</th>
                        <th>Descripcion</th>
                        <th>Editar</th>
                        
                    </tr>
                </thead>
                <tbody>
                    {% for libro in libros %}
                        <tr>
                            <td>{{libro.id}}</td>
                            <td>{{libro.nombre}}</td>
                            <td>{{libro.autor}}</td>
                            <td>{{libro.tipo}}</td>
                            <td>{{libro.cantidadint}}</td>
                            <td>{{libro.cantidadext}}</td>
                            <td>{{libro.cantidadint|add:libro.cantidadext}}</td>
                            <td>{{libro.categoria}}</td>
                            <td>{{libro.descripcion}}</td>
                            <td><form action="{% url 'Editarlibro' libro.id %}" method="POST">
                                {% csrf_token %}
                                <button type="submit" >
                                    <img src="{% static 'Biblioteca/imgprojts/edit.png' %}" alt="Editar Elemento" style="height: 25px;">
                                </button>
                            </form>
                            </td>
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    &nbsp;
{% endblock %}
